!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(w){var e,i=w(window).width(),n=w(window).height(),l=[];w(window).on("resize",function(){clearTimeout(e),e=setTimeout(function(){w(window).width()===i&&w(window).height()===n||(w(l).each(function(){w(this).flexMenu({undo:!0}).flexMenu(this.options)}),i=w(window).width(),n=w(window).height())},200)}),w.fn.flexMenu=function(e){var i,v=w.extend({threshold:2,cutoff:2,linkText:"More",linkTitle:"View More",linkTextAll:"Menu",linkTitleAll:"Open/Close Menu",shouldApply:function(){return!0},showOnHover:!0,popupAbsolute:!0,popupClass:"",undo:!1},e);return this.options=v,0<=(i=w.inArray(this,l))?l.splice(i,1):l.push(this),this.each(function(){var e,i,n,l,o,t,f=w(this),u=f.find("> li"),s=u.first(),a=u.last(),r=u.length,d=Math.floor(s.offset().top),p=(Math.floor(s.outerHeight(!0)),!1);function h(e){return Math.ceil(e.offset().top)>d+40}if(h(a)&&r>v.threshold&&!v.undo&&f.is(":visible")&&v.shouldApply()){var c=w('<ul class="flexMenu-popup"></ul>');for(c.addClass(v.popupClass),t=r;1<t;t--){if(i=h(e=f.find("> li:last-child")),t-1<=v.cutoff){w(f.children().get().reverse()).appendTo(c),p=!0;break}if(!i)break;e.appendTo(c)}p?f.append('<li class="flexMenu-viewMore flexMenu-allInPopup"><a href="#" title="'+v.linkTitleAll+'">'+v.linkTextAll+"</a></li>"):f.append('<li class="flexMenu-viewMore"><a href="#" title="'+v.linkTitle+'">'+v.linkText+"</a></li>"),h(n=f.find("> li.flexMenu-viewMore"))&&f.find("> li:nth-last-child(2)").appendTo(c),c.children().each(function(e,i){c.prepend(i)}),n.append(c),f.find("> li.flexMenu-viewMore > a").on("click",function(e){var i;i=n,w("li.flexMenu-viewMore.active").not(i).removeClass("active"),n.toggleClass("active"),e.preventDefault()}),v.showOnHover&&n.on({mouseenter:function(){w(this).addClass("active")},mouseleave:function(){w(this).removeClass("active")}})}else if(v.undo&&f.find("ul.flexMenu-popup")){for(l=(o=f.find("ul.flexMenu-popup")).find("li").length,t=1;t<=l;t++)o.find("> li:first-child").appendTo(f);o.remove(),f.find("> li.flexMenu-viewMore").remove()}})}});